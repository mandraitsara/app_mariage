{% extends 'base.html.twig'%}
{% block navbar %}
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{asset('./styles/liste.css')}}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"/>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"/>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">

{% endblock %}
{% block javascripts %}
	<script src="jquery.add-input-area.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<link rel="stylesheet" href="{{asset('./js/active.js')}}">
	<script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>

{% endblock %}

{% block title %}Budget{% endblock %}

{% block body %}
    <div class="row mt-3">       
        <div class="col-md-4 mb-3 app_budget">
            <input type="hidden" name="" id="id_prestateur" value="{{id_prestateur}}">
            <h5>Ajout Budget:</h5>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <label class="input-group-text" for="inputGroupSelect02">Type</label>
                          </div>
                        <select class="custom-select" id="id_type">                          
                          {% for type in typePrestateur %}                          
                          <option value="{{type.id}}">{{type.titre}}</option>
                          {% endfor %}
                        </select>
                       
                      </div>                    

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="basic-addon1">Prix en Ariary</span>
                        </div>
                        <input type="Number" id="price" class="form-control" placeholder="50000" aria-label="price" aria-describedby="basic-addon1">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="basic-addon1">Description</span>
                        </div>
                        <textarea class="form-control" id="description" name="" id="" cols="30" rows="10" aria-label="description" aria-describedby="basic-addon1"></textarea>
                        
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <button type="button" id="valide_tarifs" class="btn btn-success">valider</button>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <table class="table">
                        <thead class="thead-dark">
                          <tr>                            
                            <th scope="col">Type de Prestataire</th>
                            <th scope="col">Budget</th>                            
                          </tr>
                        </thead>
                        <tbody>
                        {% for  presta in prestateur %}
                            <tr>
                                <td>{{presta.type}}</td>
                                <td>{{presta.price}}</td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>                 
                      <div>
                        <span>Budget Total : {{totalPrice}}</span><span> Ariary</span>
                      </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        function PrestataireTarif(){
        let data = {
            id_prestateur: $('#id_prestateur').val(),
            id_typeprestateur : $('#id_type').val(),
            description: $("#description").val(),
            price: $("#price").val(),            
            }

            $.ajax({
            url: "/prestataire/budget/new",
            method: "PUT",
            data: data,
            success: function (response) {
            alert('L\'enregistrement a été effectué avec succès...')
            location.reload(true);
                }
                    })


        }

        $("#valide_tarifs").click(function(){
            PrestataireTarif()
        })
    </script>

{% endblock %}